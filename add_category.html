<html>
<head>
    <title>Add Menu Category</title>
    <style>
        *{
            box-sizing: border-box;
        }
        body{
            margin: 0;
            padding: 0;
            font-family: Arial, Helvetica, sans-serif;
            background-color: #f4f5fb;
        }
        h1{
            width: 500px;
            margin: 20px auto 10px;
            font-size: 26px;
            color: #111827;
        }
        #box{
            width: 500px;
            background-color: #ffffff;
            padding: 20px 30px;
            margin: 10px auto 30px;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(15,23,42,0.08);
        }
        fieldset{
            border: none;
            padding: 10px 0;
            margin: 0;
        }
        legend{
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        input[type="text"]{
            width: 300px;
            height: 30px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            padding: 4px 8px;
            background-color: #ffffff;
            font-size: 14px;
        }
        input[type="submit"]{
            padding: 8px 18px;
            background-color: #2563eb;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 6px;
        }
        input[type="submit"]:hover{
            background-color: #1d4ed8;
        }
        #categoryList{
            margin-top: 10px;
        }
        #categoryList span{
            display: inline-block;
            padding: 6px 12px;
            margin-right: 6px;
            margin-top: 8px;
            background-color: #e5e7eb;
            border-radius: 999px;
            font-size: 13px;
            color: #111827;
        }
        #categoryList a{
            margin-left: 6px;
            color: #ef4444;
            text-decoration: none;
            font-size: 12px;
        }
        #categoryList a:hover{
            text-decoration: underline;
        }
        p{
            margin: 4px 0 0 0;
            font-size: 12px;
            color: #ef4444;
        }
        h3{
            margin-top: 20px;
            margin-bottom: 6px;
            font-size: 18px;
            color: #111827;
        }
    </style>
</head>
<body>
    <h1>Menu & Categories</h1>

    <div id="box">
        <form action="" method="" enctype="" id="categoryForm" onsubmit="return test()">
            <fieldset>
                <legend>Menu Categories</legend>
                <table>
                    <tr>
                        <td>Add New Category</td>
                        <td>
                            <input type="text" id="categoryName" name="categoryName" value="" onblur="testCategoryName()">
                        </td>
                    </tr>
                    <tr>
                        <td></td>
                        <td><p id="cError"></p></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>
                            <input type="submit" name="" value="Add Category">
                        </td>
                    </tr>
                </table>
            </fieldset>
        </form>

        <h3>Existing Categories</h3>
        <div id="categoryList"></div>
    </div>

    
    <script>
        let cError = document.getElementById('cError');
        let categoryList = document.getElementById('categoryList');

        function getCategories(){
            let data = localStorage.getItem('categories');
            if(data == null || data == ""){
                return [];
            }else{
                return data.split(',');
            }
        }

        function saveCategories(categories){
            localStorage.setItem('categories', categories.join(','));
        }

        function createCategorySpan(name){
            let span = document.createElement('span');
            span.setAttribute('data-name', name);
            span.innerHTML = name + ' <a href="#" onclick="deleteCategory(this)">Delete</a>';
            categoryList.appendChild(span);
        }

        function loadCategories(){
            let categories = getCategories();
            if(categories.length == 0){
                categories = ['Starters','Main Course','Drinks'];
                saveCategories(categories);
            }
            for(let i=0; i<categories.length; i++){
                createCategorySpan(categories[i]);
            }
        }

        function categoryAlreadyExists(name){
            let categories = getCategories();
            for(let i=0; i<categories.length; i++){
                if(categories[i].toLowerCase() == name.toLowerCase()){
                    return true;
                }
            }
            return false;
        }

        function testCategoryName(){
            let categoryName = document.getElementById('categoryName').value;
            categoryName = categoryName.trim();
            if(categoryName == ""){
                cError.innerHTML = "please type category name first!";
                cError.style.color = 'red';
            }else if(categoryName.length < 3){
                cError.innerHTML = "category name must be at least 3 characters!";
                cError.style.color = 'red';
            }else if(categoryAlreadyExists(categoryName)){
                cError.innerHTML = "this category already exists!";
                cError.style.color = 'red';
            }else{
                cError.innerHTML = "";
            }
        }

        function addCategory(categoryName){
            let categories = getCategories();
            categories.push(categoryName);
            saveCategories(categories);
            createCategorySpan(categoryName);
        }

        function deleteCategory(link){
            let span = link.parentNode;
            let name = span.getAttribute('data-name');
            categoryList.removeChild(span);
            let categories = getCategories();
            let newCategories = [];
            for(let i=0; i<categories.length; i++){
                if(categories[i] != name){
                    newCategories.push(categories[i]);
                }
            }
            saveCategories(newCategories);
        }

        function test(){
            testCategoryName();
            if(cError.innerHTML !== ""){
                return false;
            }else{
                let categoryName = document.getElementById('categoryName').value;
                categoryName = categoryName.trim();
                addCategory(categoryName);
                document.getElementById('categoryName').value = "";
                return false;
            }
        }

        loadCategories();
    </script>
</body>
</html>